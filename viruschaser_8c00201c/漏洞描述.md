# 驱逐舰杀毒软件 Sysguad.sys 驱动存在本地提权漏洞

## 描述
触发漏洞的IO code是0x8c00201c，函数存在于驱动的sub_4C070中，在sub_4C070函数中，未对传入的输入进行长度检查，调用sub_237A6最多将0x106的字符串拷贝至全局指针中，而在后续的sub_32020函数中，将全局指针的字符串与一串字符串在函数sub_1A8F0中拼接保存在只有0x108大小的栈中，从而在0x3209b返回时导致可以劫持内核控制流，可以执行任意代码，exp中是执行提权shellcode。

## 测试环境
win7 32位
